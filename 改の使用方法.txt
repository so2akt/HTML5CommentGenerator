こちらはkilin氏(http://www.kilinbox.net/)の
HTML5 コメントジェネレーター(0.0.8a)をベースに機能追加したものです。

０，まずHTML5 コメントジェネレーターを用意して使えるようにしませう。
　(http://www.kilinbox.net/2016/01/HCG.html)

１，HTML5 コメントジェネレーターのフォルダ内に
　CommentGenerator.htmlとCommentGenerator.jsを上書き、
　及びsetting_ex.xmlとhcg_setting_ex.exeを追加。(配信ツールでコメジェネを開いてる場合は再起動)
　追加したファイルのブロックの解除を忘れずに。
　※CommentGenerator_multi.htmlも対応させたものを同梱

２，hcg_setting_ex.exeを開き各項目を設定。
　(setting.xmlをメモ帳等で開き、後述の使用したい項目の数値を変えて上書き保存でも可能。)
　数秒で適用されるのですでに表示されてるコメントがバグることがあるが、
　表示行数(デフォルト時3行)流れればバグったコメントは消える。(はず)　
　ただし、本体設定は配信ツールにコメジェネを読み込みし直さないといけない。
　(ツールを使った場合はinit.xmlが作成される、init.xmlがない場合は
　 CommentGenerator.html内の設定部分から読み込まれる)
　※ランダムスキンを使う場合や増やす場合は設定ツールを開いて
　　スキンフォルダを設定後、OKか適用を押してSkins.xmlを更新させること
３，設定内容(基本的には各設定0が本家と同じで違う場合は項目に記述)

　　・exColor(文字色変更)
　　　　※本家の「リスナーが背景色を指定」をオフにしてる場合のみ使用可能。
　　　　　(単体ではコテハンに『{』と数値を付けないと効果なし)
　　　　1:コテハンに付いている『{○○○○○○』の6桁の16進数を
　　　　　フォントカラーに設定。
   　   2:文字枠カラーに設定。
　　　　　
　　・ComToColor(コメントからの色変更)
　　　　※exColorが1または2、及び本家の「リスナーが背景色を指定」に影響。
　　　　1:コメント内に『{○○○○○○』の6桁の16進数が
　　　　　ある場合に直接反応。(若干処理重めかも)

　　・ComCC(色変えコマンド非表示)
　　　　1:コメント内にある色変えコマンドを
　　　　　コメジェネの表示コメントから削除。(これも若干処理重めかも)

　　・OwnerReverse(主コメの移動の左右反転)
　　　　1:主コメがリスナーコメとは左右逆に移動。
　　　　　(リスナーが右から左に流れるなら主コメは左から右へ)

　　・yReverse(コメの移動の上下反転)
　　　　1:上からスタートし、新しいコメントがくると古いコメントは下へ。

　　・TxtLine(文字揃え)
　　　　1:右揃えに。(左余白は右余白へ流用)
　　　　2:中央揃えに。(左余白は追加されたまま)
　　　　──ここからOwnerReverse用──
　　　　3:右から来るコメントは左揃え、左から来るコメントは右揃え。
　　　　4:右から来るコメントは右揃え、左から来るコメントは左揃え。

　　・Align(改行した際の揃え方の変更)
　　　　1:改行した部分も右や中央に揃える。

　　・NewLine(改行、デフォルト1回だが変更は後述)
　　　　1:文字数制限時にまずフォントを半分に、
　　　　　それでも超えた場合に1回改行。(スキン内に収める用、可読かはお察し)
　　　　2:1回改行。(コメントの重なりあり、スキンサイズで回避可能)
　　　　3:1回のみフォントを2/3に変更。(改行なし、僅かに長い時に表示用)
　　　　4:文の高さ×改行回数で移動。
　　　　5:スキンを対応させた改行。(スキンの設定方法はブロマガ参照)

　　・NLset(開始位置)
　　　　コメント表示させる基準の位置の変更。単位は行。

　　・CommentSpace(枠同士の隙間)
　　　　枠と枠の隙間、単位はpx。

　　・LineHeight(行間)
　　　　改行時の行間、初期値は2。

　　・TypeTime(1文字ずつ増やして表示)
　　　　0以外の数値にすると1文字ずつ増やして表示する。
	単位はミリ秒。

　　・OwnerColor(主コメの色指定#半強制使用)
　　　　※exColorが1もしくは2の状態のみ使用。
　　　　16進数6桁の数値入力で主コメントの色変更。

　　・In、Tar、Out、Move、Accel、Brake(移動のカスタム設定)
　　　　Tarの数値が1の場合、新しいコメントが来るとなめらかに縦移動。(Tarが0で不使用)
　　　　──setting.xmlのDirectionが3の場合のみ(つまりDirectionが3で使用)──
　　　　InのX,YからTarのX,Yに向かって移動し、Tarの位置で止まる。
　　　　そしてTarのX,YからOutのX,Yに向かって移動して消える。(InとOutの数値は係数)
　　　　RND(数値,数値)で範囲内のランダム、RND(数値:数値)で1/2の選択。
　　　　次の値をKEEPにするとその数値で固定したまま移動。
　　　　終了位置のみBACKと入力すると、開始位置として使われた値(ランダム可)に移動。
　　　　※基準はキャンバスじゃなくて通常表示される位置なので注意
　　　　Moveが1の場合、新しいコメントが来ると古いコメントをMoveのX,Yを足してずらす。
　　　　(Move内にあるc_nlX･c_nlYを1にすると、改行対応になる)
　　　　AccelとBrakeは移動パターン用のカスタム数値。
　　　　Accelが徐々に加速する際に加算されていく数値でBrakeは跳ねる強さ。

　　・MovePattern(移動パターン)
　　　　0:徐々に減速する動き(通常)
　　　　1:コメジェネの移動が一定の速度になる。
　　　　※係数を大きくすると表示位置が安定しないので注意
　　　　2:徐々に加速して、表示位置で跳ねる。

　　・NewMove(移動させる対象の変更)
　　　　1:新しいコメントの表示位置の方を操作する。

　　・HandleLimit(コテハンの最大長#強制使用)
　　　　コテハンの表示を数値分の長さに抑える。(単位はpx)

　　・HandleTrim(コテハン省略部#強制使用)
　　　　コテハンが長い場合に付ける省略文字。

　　・ComNL(改行があるコメントの扱い)
　　　　0:改行させずに埋める
　　　　1:改行扱いにする(改行使用で改行回数が残ってる場合)
　　　　2:何もしない(放置プレイ、表示崩れが起こったりする)

　　・SiteColor(サイト毎の色設定)
　　　　1:サイト毎に背景色を変える
　　　　2:サイト毎に文字色を変える
　　　　3:サイト毎に縁の色を変える

　　・Base_a(不透明度)
　　　　0で完全な透明、1で不透明
　　　　1未満の少数値で透かす

　　・F_in、F_out(フェードイン、フェードアウト)
　　　　F_inを1にすると移動中に[Base_a]で設定した不透明度までコメントが浮き出てくる。
　　　　F_outを1にするとコメントの表示時間終了時に見えなくなっていく。

　　・F_in_k、F_out_k(フェードイン、フェードアウトの係数)
　　　　フェードイン、フェードアウトの時の係数。
　　　　これはわかりやすく倍数(2にすると2倍の速さで消える)。

　　・Z_in、Z_out(ズームイン、ズームアウト)
　　　　1:左右を伸ばしながらズームイン、ズームアウト
　　　　2:上下を伸ばしながらズームイン、ズームアウト
　　　　3:全体を伸ばしながらズームイン、ズームアウト

　　・Z_in_k、Z_out_k(フェードイン、フェードアウトの係数)
　　　　ズームイン、ズームアウトの時の係数。
　　　　F_in_k、Z_in_kと同じく倍数。　　　　

　　・TimeStamp(タイムスタンプ)
　　　　1:コメジェネの背景色を使う設定の場合に
　　　　　背景色に選んだ色でタイムスタンプを表示する

　　・Ang(移動に対応した角度)
　　　　1:移動する角度に対応してコメントが斜めになる

　　・Com_Align、Skin_Align(コメント枠･スキンの基準点の位置)　
　　　　ズームイン、ズームアウトと角度を付ける際に基準になる場所を2桁の数字で表記。
　　　　※十の位　0:標準(上)　1:上　2:中　3:下
　　　　　一の位　0:標準(左)　1:左　2:中　3:右
　　　　　特殊操作として、スキンの基準点が「00」の場合のみ
　　　　　指定したスキン幅に対する画像の左右引き伸ばしが発生

　−ここからCommentGenerator.htmlをメモ帳等で開いて変更できる部分
　　(hcg_setting_ex.exeの本体設定でも可)
　　＊大きさ変更
　　　　表示範囲の大きさを変えて使いたい場合は、47〜48行目の
　　　　HcgFormat.CanvasWidth・HcgFormat.CanvasHeightの値で
　　　　変更できるように改造。(デフォルト値は512,300)

　　＊囲み文字
　　　　54〜55行目のHcgFormat.ComStart・HcgFormat.ComEndの""の内側を変えれば
　　　　コメントの囲みをかぎ括弧から変更できるように改造
　　　　(何も入れなければなくすことも可能なはず)

　　＊デモモードの微調整
　　　　デモモードに使う設定をわかりやすく
　　　　上部へ抜き出し(57〜60行目)

　　＊移動の速度変更
　　　　62行目のHcgFormat.MoveSpeedの数値を変えると
　　　　流れてくる時の速度が変わる(基本値は0.1)
　　　　※ただし、0.5以上にするのは危険な気がする

　　＊改行回数
　　　　NewLineを1,2,4,5にしている場合に
　　　　51行目のHcgFormat.LineLimitの数値が改行の最大回数

　　＊アニメーション(後述)の速度
　　　　52行目のHcgFormat.AnimeSpeedの数値を変えると
　　　　スキンのアニメーション速度が変わる(フレームレートに乗算？)
　　　　1で30FPS、初期値は0.5なので15FPS

　　＊読み込み間隔の変更
　　　　62行目のHcgFormat.LoadInterbalの数値を変えると
　　　　Comment.xmlを読み込む間隔を変更できる。初期値は500(ミリ秒)。
　　　　※500未満の数値にすると読み込み頻度が上がって
　　　　　同時コメント等がすぐに表示されるようになるが
　　　　　その分の影響は未確認です

　−ここからは内部の変更部分
　　＊スキンのアニメーション対応
　　　　スキンを使用している時、CommentGenerator.htmlの44行目の
　　　　HcgFormat.SkinHeightより画像の縦が大きい場合、
　　　　自動的にHcgFormat.SkinHeightの高さで画像を分割して
　　　　アニメーションをさせるように改造。
　　　　(簡単に言えば、縦にコマを並べた画像を用意すればアニメーション)

　　＊設定ツールから複数のコメジェネ生成
　　　　設定ツールの左下にある追加から任意の文字列を付けたコメジェネを生成。
　　　　生成後は左下の選択欄から設定した文字列を選択して切り替えて
　　　　別々に設定が可能。(最初からあるコメジェネは「(default)」で設定)

　　＊同時間に来たコメントの読み込み
　　　　マルチコメントビュアーの仕様でコメントNoが使えないので
　　　　読み込んだXMLの行数を記憶しておくようにした。
　　　　これにより待機処理がちょっと軽くなるかも。

　　＊枠外削除、軽量化？(機能盛りすぎて本家より重いが…)
　　　　設定時間後に消すで外に出たコメントを、5秒後に消すように変更。
　　　　(枠外に残っていた物、設定によっては見えていた)
　　　　ついでに、削除後に中で動いていた処理も止めるように変更。
　　　　※これにより不具合が起こるかもしれないので
　　　　　その際は報告お願いしますm(_ _)m
　　　　　(とりあえず報告なかったのでNoDelete版の同梱終了)

４，おまけ

　初期化
　　setting.xml、setting_ex.xml、init.xmlを削除し設定ツールを起動すると
　　デフォルトが入力されるので、そのままOKや適用すると初期状態に戻せる。


　棒読みちゃんを使っている放送で色変更の数値を読ませたくない場合
　　辞書登録→単語→正規表現を開き、
　　優先度『1』・探索文字列『{』・正規表現『\{\#?[0-9A-Fa-f]{6}』
　　と入力。(『』内の文字)
　　置換後は空白のまま新規追加を押す。

　こまめに掃除
　　comment.xmlが肥大化している場合は、(たまに自動で消えてるけど)
　　メモ帳等で開き『<log>』と『</log>』を残して削除をおすすめ。
　　(開いた後Ctrl+Aで全選択してDelを押して消して、
　　 1行目『<log>』改行して2行目『</log>』を書いて保存でもOK
　　 ※0.0.8のプラグインはcomment.xml自体を削除してコメビュの方を再起動でもOK)

───────────────────────────────
CommentGenerator.html
CommentGenerator_multi.html
CommentGenerator.js



Copyright (c) 2015 Takayasu Machimura (kilin)
Released under the MIT License
───────────────────────────────